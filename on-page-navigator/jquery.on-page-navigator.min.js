//
// jquery.on-page-navigator
// desc: add one page navigation based on anchors, highlights current page position
// version: 0.2
// requires: jQuery 1.7+

// how to use?
// init:     $(parent_selector).onPageNavigator(options)
// destroy:  $(parent_selector).onPageNavigator('destroy')

// options:
//   speed: 1000                      // speed of autoscroll
//   topOffset: 0                     // top offset of destination position
//   callbackBefore: (el) ->          // callback before autoscroll begins, gets raw clicked element
//   callbackAfter: (el) ->           // callback after autoscroll ends, gets raw clicked element
//   callbackGetHighlight: (el) ->    // callback when current navigation element is highlighted, gets raw current element
//   callbackLostHighlight: ->        // callback when all elements lost highlight, means window is outside of any element in page navigation

;(function(){var a,b,c,d;a=jQuery,d=null,a.fn.onPageNavigator=function(b){return c[b]?c[b].apply(this,Array.prototype.slice.call(arguments,1)):typeof b=="object"||!b?c.init.apply(this,arguments):a.error("Method "+b+" does not exist on jQuery.onPageNavigator")},c={init:function(c){var e,f;return e={speed:1e3,topOffset:0,callbackBefore:function(){},callbackAfter:function(){},callbackGetHighlight:function(){},callbackLostHighlight:function(){}},f=a.extend({},e,c),d=new b(this,f),this},destroy:function(){return d.destroy(),this}},b=function(){function b(a,b){this.parent=a,this.settings=b,this.initNavigateEvent(),this.initHighlightingEvent()}return b.prototype.initNavigateEvent=function(){var b=this;return a(this.parent).on("click.navigator","a",function(a){return a.preventDefault(),b.onNavigate(a.target)})},b.prototype.onNavigate=function(b){var c,d,e,f;return c=a(b),f=this.settings,f.callbackBefore(b),e=c.attr("href"),d=a(e).offset().top-f.topOffset,a("html:not(:animated),body:not(:animated)").animate({scrollTop:d},f.speed,function(){return f.callbackAfter(b)})},b.prototype.initHighlightingEvent=function(){var b,c,d=this;return c=[],b=a(this.parent),b.find("a").each(function(b){return c.push(a(this).attr("href"))}),a(window).on("scroll.navigator",function(a){return d.highlight(a.target,c)})},b.prototype.highlight=function(b,c){var d,e,f,g,h,i,j,k,l;i=a(b).scrollTop(),f=null,d=a(this.parent);for(k=0,l=c.length;k<l;k++)h=c[k],j=a(h).offset().top-this.settings.topOffset-10,g=a(h).offset().top+a(h).outerHeight(),i>j&&i<g&&(f=h);return f!==null?(d.find("a").removeClass("active"),e=d.find("a[href="+f+"]"),e.addClass("active"),this.settings.callbackGetHighlight(e[0])):(d.find("a").removeClass("active"),this.settings.callbackLostHighlight())},b.prototype.destroy=function(){return a(this.parent).off(".navigator"),a(window).off(".navigator")},b}()}).call(this);